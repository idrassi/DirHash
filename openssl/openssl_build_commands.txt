For x64: 

perl Configure VC-WIN64A no-uplink no-shared no-sock no-static-engine no-stdio no-tests no-quic no-threads no-thread-pool no-ts no-ui-console no-tls no-dtls no-ct no-dgram no-docs no-dso no-dynamic-engine no-ec no-ec2m no-engine no-err no-filenames no-fips-securitychecks no-gost no-http no-ocsp no-psk no-rdrand no-rfc3779 no-zlib no-ssl3-method no-tls1-method no-tls1_1-method no-tls1_2-method no-dtls1-method no-dtls1_2-method no-aria no-bf no-blake2 no-camellia no-cast no-chacha no-cmac no-des no-dh no-dsa no-ecdh no-ecdsa no-idea no-md4 no-mdc2 no-ocb no-poly1305 no-rc2 no-rc4 no-rmd160 no-scrypt no-seed no-siphash no-siv no-sm2 no-sm3 no-sm4 no-whirlpool --prefix=C:\dev\libraries\openssl\x64 --openssldir=C:\dev\libraries\openssl\x64

For x86:

perl Configure VC-WIN32 no-uplink no-shared no-sock no-static-engine no-stdio no-tests no-quic no-threads no-thread-pool no-ts no-ui-console no-tls no-dtls no-ct no-dgram no-docs no-dso no-dynamic-engine no-ec no-ec2m no-engine no-err no-filenames no-fips-securitychecks no-gost no-http no-ocsp no-psk no-rdrand no-rfc3779 no-zlib no-ssl3-method no-tls1-method no-tls1_1-method no-tls1_2-method no-dtls1-method no-dtls1_2-method no-aria no-bf no-blake2 no-camellia no-cast no-chacha no-cmac no-des no-dh no-dsa no-ecdh no-ecdsa no-idea no-md4 no-mdc2 no-ocb no-poly1305 no-rc2 no-rc4 no-rmd160 no-scrypt no-seed no-siphash no-siv no-sm2 no-sm3 no-sm4 no-whirlpool --prefix=C:\dev\libraries\openssl --openssldir=C:\dev\libraries\openssl

